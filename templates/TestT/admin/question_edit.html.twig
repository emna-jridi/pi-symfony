{% extends 'base.html.twig' %}

{% block title %}Modifier la Question{% endblock %}

{% block body %}
    <div class="container mt-4">
        <h1>Modifier la question</h1>
        
        <div class="mb-4">
            <a href="{{ path('app_admin_question_index') }}" class="btn btn-secondary">Retour</a>
        </div>
        
        <div class="card">
            <div class="card-body">
                {{ form_start(form) }}
                    <div class="mb-3">
                        {{ form_label(form.question) }}
                        {{ form_widget(form.question) }}
                        {{ form_errors(form.question) }}
                    </div>
                    
                    <div class="mb-3">
                        {{ form_label(form.categorie) }}
                        {{ form_widget(form.categorie) }}
                        {{ form_errors(form.categorie) }}
                    </div>
                    
                    <div class="mb-3">
                        {{ form_label(form.difficulte) }}
                        {{ form_widget(form.difficulte) }}
                        {{ form_errors(form.difficulte) }}
                    </div>
                    
                    <div class="mb-3">
                        <h5>{{ form_label(form.options) }}</h5>
                        <div id="options-container" class="border p-3 rounded mb-2">
                            {% for optionField in form.options %}
                                <div class="mb-2 option-item">
                                    <div class="input-group">
                                        <span class="input-group-text">Option {{ loop.index }}</span>
                                        {{ form_widget(optionField) }}
                                    </div>
                                </div>
                            {% endfor %}
                        </div>
                        {{ form_errors(form.options) }}
                    </div>
                    
                    <div class="mb-3">
                        {{ form_label(form.reponseCorrecte) }}
                        {{ form_widget(form.reponseCorrecte) }}
                        {{ form_errors(form.reponseCorrecte) }}
                    </div>
                    
                    <button type="submit" class="btn btn-primary">Mettre à jour</button>
                {{ form_end(form) }}
            </div>
        </div>
    </div>
{% endblock %}

{% block javascripts %}
{{ parent() }}
<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Mettre à jour les labels dans le select de la réponse correcte
        const updateCorrectAnswerOptions = function() {
            const options = document.querySelectorAll('.option-item input');
            const reponseSelect = document.querySelector('#question_technique_reponseCorrecte');
            
            if (!reponseSelect) return;
            
            const selectOptions = reponseSelect.options;
            
            options.forEach((option, index) => {
                if (index < selectOptions.length) {
                    const optionText = option.value.trim() || `Option ${index + 1}`;
                    selectOptions[index].text = optionText;
                }
            });
        };
        
        // Événement sur le changement d'une option
        document.querySelectorAll('.option-item input').forEach(input => {
            input.addEventListener('input', updateCorrectAnswerOptions);
        });
        
        // Initialiser au chargement
        updateCorrectAnswerOptions();
    });
</script>
{% endblock %}
